alter session  set container = xepdb1;

select * from all_tables where owner = 'LTCGUN';

create table ESTADO_PRODUCTO (
    id_EDO_PRODUCTO nvarchar2 (4) NOT NULL,
    clasificacion varchar2 (8) NOT NULL,
    constraint estado_producto_pk primary key (id_EDO_PRODUCTO)
    );
CREATE INDEX ESTADO_PRODUCTO_IDX ON
    ESTADO_PRODUCTO (
        ID_EDO_PROUCTO
    ASC );

create table CATEGORIA (
    id_CATEGORIA nvarchar2 (5) NOT NULL,
    TIPO char (20) NOT NULL,
    constraint CATEGORIA_pk primary key (id_CATEGORIA)
    );
CREATE INDEX CATEGORIA_IDX ON
    CATEGORIA (
        ID_CATEGORIA
    ASC );

create table MARCA (
    id_MARCA nvarchar2 (3) NOT NULL,
    NOMBRE_MARCA NVARCHAR2 (30) NOT NULL,
    constraint MARCA_pk primary key (id_MARCA)
    );
CREATE INDEX MARCA_IDX ON
    MARCA (
        ID_MARCA
    ASC );

create table METODO_PAGO (
    id_MET_PAGO NUMBER (1) NOT NULL,
    METODO NVARCHAR2 (20) NOT NULL,
    constraint METODO_PAGO_pk primary key (id_MET_PAGO)
    );
CREATE INDEX METODO_PAGO_IDX ON
    METODO_PAGO (
        ID_MET_PAGO
    ASC );

create table ESTADO_VENTA (
    id_EDO_VENTA NUMBER (1) NOT NULL,
    ESTADO VARCHAR2 (13) NOT NULL,
    constraint ESTADO_VENTA_pk primary key (id_EDO_VENTA)
    );
CREATE INDEX ESTADO_VENTA_IDX ON
    ESTADO_VENTA (
        ID_EDO_VENTA
    ASC );

create table PUESTO (
    id_PUESTO VARCHAR2 (2) NOT NULL,
    PUESTO CHAR (18) NOT NULL,
    constraint PUESTO_pk primary key (id_PUESTO)
    );
CREATE INDEX PUESTO_IDX ON
    PUESTO (
        ID_PUESTO
    ASC );

create table EDO_COMPRA (
    id_EDO_COMPRA NUMBER (1) NOT NULL,
    ESTADO_COMPRA CHAR (15) NOT NULL,
    constraint EDO_COMPRA_pk primary key (id_EDO_COMPRA)
    );
CREATE INDEX EDO_COMPRA_IDX ON
    EDO_COMPRA (
        ID_EDO_COMPRA
    ASC );

create table ESTADO (
    id_ESTADO NVARCHAR2 (4) NOT NULL,
    ESTADO NVARCHAR2 (20) NOT NULL,
    constraint ESTADO_pk primary key (id_ESTADO)
    ); 
CREATE INDEX ESTADO_IDX ON
    ESTADO (
        ID_ESTADO
    ASC );   
    
    CREATE TABLE DIRECCION (
        ID_DIRECCION NVARCHAR2 (3) NOT NULL,
        ID_ESTADO NVARCHAR2 (4) NOT NULL,
        ALCAL_MUN NVARCHAR2 (20) NOT NULL,
        COLONIA VARCHAR2 (40) NOT NULL,
        CP NVARCHAR2 (6) NOT NULL,
        CALLE VARCHAR2 (40) NOT NULL,
        EXTERIOR NVARCHAR2 (5) NOT NULL,
        INTERIOR NVARCHAR2 (10),
        CONSTRAINT DIRECCION_PK PRIMARY KEY (ID_DIRECCION),
        CONSTRAINT DIRECCION_ESTADO_FK FOREIGN KEY (ID_ESTADO) REFERENCES ESTADO (ID_ESTADO)
        );
CREATE INDEX DIRECCION_IDX ON
    DIRECCION (
        ID_DIRECCION
    ASC );

CREATE TABLE PROVEEDOR (
    ID_PROVEEDOR NVARCHAR2 (4) NOT NULL,
    NOMBRE_EMPRESA CHAR (50) NOT NULL,
    NOMBRE_CONTACTO CHAR (30) NOT NULL,
    LADA NUMBER (3) not null,
    TELEFONO CHAR (11) NOT NULL,
    EXTENSION NUMBER (3),
    CORREO NVARCHAR2 (30) NOT NULL,
    ID_DIRECCION NVARCHAR2 (3) NOT NULL,
    CONSTRAINT PROVEEDOR_PK PRIMARY KEY (ID_PROVEEDOR),
    CONSTRAINT PROVEEDOR_DIRECCION_FK FOREIGN KEY (ID_DIRECCION) REFERENCES DIRECCION (ID_DIRECCION)
    );
ALTER TABLE PROVEEDOR ADD CONSTRAINT PROVEEDOR_CORREO_UN UNIQUE ( CORREO );
CREATE INDEX PROVEEDOR_IDX ON
    PROVEEDOR (
        ID_PROVEEDOR
    ASC );
CREATE INDEX PROVEEDOR_CORREO_UN ON
    CLIENTE (
        CORREO
    ASC );

CREATE TABLE CLIENTE (
        ID_CLIENTE NVARCHAR2 (5) NOT NULL,
        NOMBRE CHAR (30) NOT NULL,
        AP_PATERNO CHAR (15) NOT NULL,
        AP_MATERNO CHAR (15),
        FECHA_REG DATE NOT NULL,
        CORREO NVARCHAR2(30) NOT NULL,
        ID_DIRECCION NVARCHAR2(3) NOT NULL,
        
        CONSTRAINT CLIENTE_PK PRIMARY KEY (ID_CLIENTE),
        CONSTRAINT CLIENTE_DIRECCION_FK FOREIGN KEY (ID_DIRECCION) REFERENCES DIRECCION (ID_DIRECCION)
    
    );

ALTER TABLE CLIENTE ADD CONSTRAINT CLIENTE_CORREO_UN UNIQUE ( CORREO );

CREATE INDEX CLIENTE_IDX ON
    CLIENTE (
        ID_CLIENTE
    ASC );

CREATE INDEX CLIENTE_CORREO_UN ON
    CLIENTE (
        CORREO
    ASC );

CREATE TABLE EMPLEADO (
    ID_EMPLEADO NVARCHAR2 (5) not null,
    NOMBRE VARCHAR2 (30) NOT NULL,
    AP_PATERNO CHAR (15) NOT NULL,
    AP_MATERNO CHAR (15),
    FECHA_REG DATE NOT NULL,
    CORREO VARCHAR2 (30) NOT NULL,
    ID_PUESTO VARCHAR2 (2) NOT NULL,
    SUELDO FLOAT (10) NOT NULL,
    USUARIO_EMPLEADO NVARCHAR2 (10) NOT NULL,
    CONTRASENIA_EMPLEADO NVARCHAR2 (10) NOT NULL,
    ID_DIRECCION NVARCHAR2 (3) NOT NULL,
    CONSTRAINT EMPLEADO_PK PRIMARY KEY (ID_EMPLEADO),
    CONSTRAINT  EMPLEADO_PUESTO_FK FOREIGN KEY (ID_PUESTO) REFERENCES PUESTO (ID_PUESTO),
    CONSTRAINT EMPLEADO_DIRECCION_FK FOREIGN KEY (ID_DIRECCION) REFERENCES DIRECCION (ID_DIRECCION)
    );
ALTER TABLE EMPLEADO ADD CONSTRAINT EMPLEADO_CORREO_UN UNIQUE ( CORREO );

CREATE INDEX EMPLEADO_IDX ON
    EMPLEADO (
        ID_EMPLEADO
    ASC );
CREATE INDEX EMPLEADO_CORREO_UN ON
    EMPLEADO (
        CORREO
    ASC );

create table PRODUCTO (
    ID_PRODUCTO NCHAR (8) NOT NULL,
    NOMBRE NVARCHAR2 (20) NOT NULL,
    DESCRIPCION NVARCHAR2 (300),
    SKU VARCHAR2 (20) NOT NULL,
    ID_CATEGORIA NVARCHAR2 (5) NOT NULL,
    ID_ESTADO_PRODUCTO NVARCHAR2 (4) NOT NULL,
    ID_PROVEEDOR NVARCHAR2(4) NOT NULL,
    STOCK NUMBER (4) NOT NULL,
    STOCK_MIN NUMBER (4),
    PRECIO FLOAT (6) NOT NULL,
    PISO NUMBER (2) NOT NULL,
    ZONA CHAR (1) NOT NULL,
    ESTANTERIA NUMBER (2) NOT NULL,
    ID_MARCA NVARCHAR2 (3) NOT NULL,
    CONSTRAINT PRODUCTO_PK PRIMARY KEY (ID_PRODUCTO),
    CONSTRAINT PRODUCTO_CATEGORIA_FK FOREIGN KEY (ID_CATEGORIA) REFERENCES CATEGORIA (ID_CATEGORIA),
    CONSTRAINT PRODUCTO_ESTADO_PRODUCTO_FK FOREIGN KEY (ID_ESTADO_PRODUCTO) REFERENCES ESTADO_PRODUCTO (ID_EDO_PRODUCTO),
    CONSTRAINT PRODUCTO_PROVEEDOR_FK FOREIGN KEY (ID_PROVEEDOR) REFERENCES PROVEEDOR (ID_PROVEEDOR),
    CONSTRAINT PRODUCTO_MARCA_FK FOREIGN KEY (ID_MARCA) REFERENCES MARCA (ID_MARCA)
    );

CREATE INDEX PRODUCTO_IDX ON
    PRODUCTO (
        ID_PRODUCTO
    ASC );

CREATE TABLE COMPRA (
    ID_COMPRA NVARCHAR2 (8) NOT NULL,
    FECHA_COMPRA DATE NOT NULL,
    ID_EDO_COMPRA NUMBER (1) NOT NULL,
    ID_PROVEEDOR NVARCHAR2 (4) NOT NULL,
    ID_EMPLEADO NVARCHAR2 (5) NOT NULL,
    CONSTRAINT COMPRA_PK PRIMARY KEY (ID_COMPRA),
    CONSTRAINT COMPRA_EDO_COMPRA_FK FOREIGN KEY (ID_EDO_COMPRA) REFERENCES EDO_COMPRA (ID_EDO_COMPRA),
    CONSTRAINT COMPRA_PROVEEDOR_FK FOREIGN KEY (ID_PROVEEDOR) REFERENCES PROVEEDOR (ID_PROVEEDOR),
    CONSTRAINT COMPRA_EMPLEADO_FK FOREIGN KEY (ID_EMPLEADO) REFERENCES EMPLEADO (ID_EMPLEADO)
    );
CREATE INDEX COMPRA_IDX ON
    COMPRA (
        ID_COMPRA
    ASC );

CREATE TABLE VENTA (
    ID_VENTA NVARCHAR2 (8) NOT NULL,
    FECHA_VENTA DATE NOT NULL,
    ID_EDO_VENTA NUMBER (1) NOT NULL,
    ID_CLIENTE NVARCHAR2(5) NOT NULL,
    ID_EMPLEADO NVARCHAR2 (5) NOT NULL,
    ID_MET_PAGO NUMBER (1) NOT NULL,
    CONSTRAINT VENTA_PK PRIMARY KEY (ID_VENTA),
    CONSTRAINT VENTA_EDO_VENTA_FK FOREIGN KEY (ID_EDO_VENTA) REFERENCES ESTADO_VENTA (ID_EDO_VENTA),
    CONSTRAINT VENTA_CLIENTE_FK FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE (ID_CLIENTE),
    CONSTRAINT VENTA_EMPLEADO_FK FOREIGN KEY (ID_EMPLEADO) REFERENCES EMPLEADO (ID_EMPLEADO),
    CONSTRAINT VENTA_METODO_PAGO_FK FOREIGN KEY (ID_MET_PAGO) REFERENCES METODO_PAGO (ID_MET_PAGO)
    );

CREATE INDEX VENTA_IDX ON
    VENTA (
        ID_VENTA
    ASC );
    
CREATE TABLE DETALLE_VENTA (
    CANTIDAD NUMBER (5) NOT NULL,
    ID_PRODUCTO NCHAR (8) NOT NULL,
    ID_VENTA NVARCHAR2 (8) NOT NULL,
    CONSTRAINT DETALLE_VENTA_PK PRIMARY KEY (ID_PRODUCTO, ID_VENTA),
    CONSTRAINT DETALLE_VENTA_PRODUCTO_FK FOREIGN KEY (ID_PRODUCTO) REFERENCES PRODUCTO (ID_PRODUCTO),
    CONSTRAINT DETALLE_VENTA_VENTA_FK FOREIGN KEY (ID_VENTA) REFERENCES VENTA (ID_VENTA)
    );

CREATE INDEX DETALLE_VENTA_IDX ON
    DETALLE_VENTA (
        PRODUCTO_ID_PRODUCTO
    ASC,
        VENTA_ID
    ASC );


CREATE TABLE DETALLE_COMPRA (
    CANTIDAD NUMBER (5) NOT NULL,
    ID_PRODUCTO NCHAR (8) NOT NULL,
    ID_COMPRA NVARCHAR2(8) NOT NULL,
    CONSTRAINT DETALLE_COMPRA_PK PRIMARY KEY (ID_PRODUCTO, ID_COMPRA),
    CONSTRAINT DETALLE_COMPRA_PRODUCTO_FK FOREIGN KEY (ID_PRODUCTO) REFERENCES PRODUCTO (ID_PRODUCTO),
    CONSTRAINT DETALLE_COMPRA_COMPRA_FK FOREIGN KEY (ID_COMPRA) REFERENCES COMPRA (ID_COMPRA)
    );

CREATE INDEX DETALLE_COMPRA_IDX ON
    DETALLE_COMPRA (
        PRODUCTO_ID_PRODUCTO
    ASC,
        COMPRA_ID
    ASC );